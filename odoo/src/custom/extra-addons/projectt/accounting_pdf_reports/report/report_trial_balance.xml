<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_trialbalance">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <style>
                    h4 {
                    text-align: center;
                    text-transform: uppercase;
                    color: #675fb3;
                    }

                    .th_style {
                    font-weight: bolder;
                    background-color: #f2f2f2;
                    color: #675fb3;
                    border-left: 1px solid black;
                    }

                    td {
                    border-left: 1px solid black;
                    width:auto;
                    }

                    .td_top {
                    border-top: 1px solid black;
                    }

                    .wd_4{
                    width:10%;
                    }

                    .row {
                    margin-bottom: 10px;
                    width:90%;

                    }

                    .col-4 {
                    border: 1px solid #675fb3;
                    padding:5px;
                    margin-left:2px;
                    }
                    .page{
                    font-size:12px;
                    }
                    .row {
                    width:100%;
                    }
                </style>
                <div class="page">
                    <h4><span t-esc="res_company.name"/>: Trial Balance
                    </h4>

                    <div class="row mt32">
                        <div class="col-4">
                            <strong>Display Account:</strong>
                            <p>
                                <span t-if="data['display_account'] == 'all'">All accounts</span>
                                <span t-if="data['display_account'] == 'movement'">With movements</span>
                                <span t-if="data['display_account'] == 'not_zero'">With balance not equal to zero</span>
                            </p>
                        </div>
                        <div class="col-4">
                            <p>
                                <t t-if="data['date_from']">
                                    <strong>Date from :</strong>
                                    <span t-esc="data['date_from']"/>
                                    <br/>
                                </t>
                                <t t-if="data['date_to']">
                                    <strong>Date to :</strong>
                                    <span t-esc="data['date_to']"/>
                                </t>
                            </p>
                        </div>
                        <div class="col-4">
                            <strong>Target Moves:</strong>
                            <p>
                                <span t-if="data['target_move'] == 'all'">All Entries</span>
                                <span t-if="data['target_move'] == 'posted'">All Posted Entries</span>
                            </p>
                        </div>
                    </div>
                    <t t-set="total_debit_s" t-value="0"/>
                    <t t-set="total_credit_s" t-value="0"/>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th class="th_style">Numéro de compte</th>
                                <th class="th_style">Intitulé des comptes</th>
                                <th class="th_style text-center">Initial Balance</th>
                                <th class="th_style text-center" colspan="2">Mouvements</th>
                                <th class="th_style text-center" colspan="2">Soldes</th>
                            </tr>
                            <tr>
                                <th class="th_style"/>
                                <th class="th_style"/>
                                <th class="th_style"/>
                                <th class="td_top th_style text-center">Debit</th>
                                <th class="td_top th_style text-center">Credit</th>
                                <th class="td_top th_style text-center">Debit</th>
                                <th class="td_top th_style text-center">Credit</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="Accounts" t-as="account">
                                <td>
                                    <span t-att-style="style" t-esc="account['code']"/>
                                </td>
                                <td>
                                    <span style="color: white;" t-esc="'..'"/>
                                    <span t-att-style="style" t-esc="account['name']"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="account['initial_balance'] &gt; 0" t-att-style="style"
                                          t-esc="account['initial_balance']"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="account['debit'] &gt; 0" t-att-style="style" t-esc="account['debit']"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="account['credit'] &gt; 0" t-att-style="style" t-esc="account['credit']"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="account['debit']-account['credit'] &gt; 0" t-att-style="style"
                                          t-esc="account['balance']"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    <t t-set="total_debit_s" t-value="total_debit_s + account['balance']"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="account['debit']-account['credit'] &lt; 0" t-att-style="style"
                                          t-esc="account['balance']*-1"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                    <t t-set="total_credit_s" t-value="total_debit_s + account['balance']"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th class="th_style">Numéro de compte</th>
                                <th class="th_style">Intitulé des comptes</th>
                                <th class="th_style text-center">Initial Balance</th>
                                <th class="th_style text-center" colspan="2">Mouvements</th>
                                <th class="th_style text-center" colspan="2">Soldes</th>
                            </tr>
                            <tr>
                                <th class="th_style"/>
                                <th class="th_style"/>
                                <th class="th_style"/>
                                <th class="td_top th_style text-center">Debit</th>
                                <th class="td_top th_style text-center">Credit</th>
                                <th class="td_top th_style text-center">Debit</th>
                                <th class="td_top th_style text-center">Credit</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>

                                <t t-set="total_debit_b" t-value="0"/>
                                <t t-set="total_credit_b" t-value="0"/>
                                <t t-foreach="Accounts" t-as="account">
                                    <t t-if="account['code'].startswith('1') or account['code'].startswith('2') or account['code'].startswith('3') or account['code'].startswith('4') or account['code'].startswith('5')">
                                        <t t-set="total_debit_b" t-value="total_debit_b + account['debit']"/>
                                        <t t-set="total_credit_b" t-value="total_credit_b + account['credit']"/>
                                    </t>
                                </t>
                                <td colspan="3">Totaux comptes de bilan</td>
                                <td class="text-end">
                                    <span t-att-style="style" t-esc="total_debit_b"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-att-style="style" t-esc="total_credit_b"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="total_debit_b-total_credit_b &gt; 0" t-att-style="style"
                                          t-esc="total_debit_b-total_credit_b"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="total_debit_b-total_credit_b &lt; 0" t-att-style="style"
                                          t-esc="(total_debit_b-total_credit_b)*-1"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                            </tr>
                            <tr>
                                <t t-set="total_debit_g" t-value="0"/>
                                <t t-set="total_credit_g" t-value="0"/>
                                <t t-foreach="Accounts" t-as="account">
                                    <t t-if="account['code'].startswith('6') or account['code'].startswith('7') or account['code'].startswith('8') or account['code'].startswith('9')">
                                        <t t-set="total_debit_g" t-value="total_debit_g + account['debit']"/>
                                        <t t-set="total_credit_g" t-value="total_credit_g + account['credit']"/>
                                    </t>
                                </t>
                                <td colspan="3">Totaux comptes de gestion</td>
                                <td class="text-end">
                                    <span t-att-style="style" t-esc="total_debit_g"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-att-style="style" t-esc="total_credit_g"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="total_debit_g-total_credit_g &gt; 0" t-att-style="style"
                                          t-esc="total_debit_g-total_credit_g"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="total_debit_g-total_credit_g &lt; 0" t-att-style="style"
                                          t-esc="(total_debit_g-total_credit_g)*-1"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                            </tr>
                            <t t-set="solde_f" t-value="(total_debit_b+total_debit_g)-(total_credit_g+total_credit_b)"/>
                            <tr>
                                <td colspan="3">Totaux de la balance</td>
                                <td class="text-end">
                                    <span t-att-style="style" t-esc="total_debit_b+total_debit_g"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-att-style="style" t-esc="total_credit_g+total_credit_b"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="solde_f &gt; 0" t-esc="solde_f"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-if="solde_f &lt; 0" t-esc="solde_f"
                                          t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </t>
        </t>
    </template>

</odoo>
